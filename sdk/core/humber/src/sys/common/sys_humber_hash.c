/**
 @file sim_hash.c

 @date 2010-02-25

 @version v5.1

 The file implement hash CRC arithmetic
*/

#include "sys_humber_hash.h"

/**
 @brief mac hash left bucket arithmetic
*/
int16
sys_humber_hash_generate_mac_hash0(uint8* sed, uint32 bit_num)
{
    uint8 D[64] = {0}, C[16] = {0};
    uint8 NewCRC[16] = {0};
    uint32 i ;
    int16 result = 0;

    for (i = 0; i < 64; i++)
    {
        D[i] = IS_BIT_SET(sed[i/8], i%8);
    }

    NewCRC[0] = D[63] ^ D[62] ^ D[61] ^ D[60] ^ D[55] ^ D[54] ^ D[53] ^
                D[52] ^ D[51] ^ D[50] ^ D[49] ^ D[48] ^ D[47] ^ D[46] ^
                D[45] ^ D[43] ^ D[41] ^ D[40] ^ D[39] ^ D[38] ^ D[37] ^
                D[36] ^ D[35] ^ D[34] ^ D[33] ^ D[32] ^ D[31] ^ D[30] ^
                D[27] ^ D[26] ^ D[25] ^ D[24] ^ D[23] ^ D[22] ^ D[21] ^
                D[20] ^ D[19] ^ D[18] ^ D[17] ^ D[16] ^ D[15] ^ D[13] ^
                D[12] ^ D[11] ^ D[10] ^ D[9] ^ D[8] ^ D[7] ^ D[6] ^
                D[5] ^ D[4] ^ D[3] ^ D[2] ^ D[1] ^ D[0] ^ C[0] ^ C[1] ^
                C[2] ^ C[3] ^ C[4] ^ C[5] ^ C[6] ^ C[7] ^ C[12] ^ C[13] ^
                C[14] ^ C[15];
    NewCRC[1] = D[63] ^ D[62] ^ D[61] ^ D[56] ^ D[55] ^ D[54] ^ D[53] ^
                D[52] ^ D[51] ^ D[50] ^ D[49] ^ D[48] ^ D[47] ^ D[46] ^
                D[44] ^ D[42] ^ D[41] ^ D[40] ^ D[39] ^ D[38] ^ D[37] ^
                D[36] ^ D[35] ^ D[34] ^ D[33] ^ D[32] ^ D[31] ^ D[28] ^
                D[27] ^ D[26] ^ D[25] ^ D[24] ^ D[23] ^ D[22] ^ D[21] ^
                D[20] ^ D[19] ^ D[18] ^ D[17] ^ D[16] ^ D[14] ^ D[13] ^
                D[12] ^ D[11] ^ D[10] ^ D[9] ^ D[8] ^ D[7] ^ D[6] ^
                D[5] ^ D[4] ^ D[3] ^ D[2] ^ D[1] ^ C[0] ^ C[1] ^ C[2] ^
                C[3] ^ C[4] ^ C[5] ^ C[6] ^ C[7] ^ C[8] ^ C[13] ^ C[14] ^
                C[15];
    NewCRC[2] = D[61] ^ D[60] ^ D[57] ^ D[56] ^ D[46] ^ D[42] ^ D[31] ^
                D[30] ^ D[29] ^ D[28] ^ D[16] ^ D[14] ^ D[1] ^ D[0] ^
                C[8] ^ C[9] ^ C[12] ^ C[13];
    NewCRC[3] = D[62] ^ D[61] ^ D[58] ^ D[57] ^ D[47] ^ D[43] ^ D[32] ^
                D[31] ^ D[30] ^ D[29] ^ D[17] ^ D[15] ^ D[2] ^ D[1] ^
                C[9] ^ C[10] ^ C[13] ^ C[14];
    NewCRC[4] = D[63] ^ D[62] ^ D[59] ^ D[58] ^ D[48] ^ D[44] ^ D[33] ^
                D[32] ^ D[31] ^ D[30] ^ D[18] ^ D[16] ^ D[3] ^ D[2] ^
                C[0] ^ C[10] ^ C[11] ^ C[14] ^ C[15];
    NewCRC[5] = D[63] ^ D[60] ^ D[59] ^ D[49] ^ D[45] ^ D[34] ^ D[33] ^
                D[32] ^ D[31] ^ D[19] ^ D[17] ^ D[4] ^ D[3] ^ C[1] ^
                C[11] ^ C[12] ^ C[15];
    NewCRC[6] = D[61] ^ D[60] ^ D[50] ^ D[46] ^ D[35] ^ D[34] ^ D[33] ^
                D[32] ^ D[20] ^ D[18] ^ D[5] ^ D[4] ^ C[2] ^ C[12] ^
                C[13];
    NewCRC[7] = D[62] ^ D[61] ^ D[51] ^ D[47] ^ D[36] ^ D[35] ^ D[34] ^
                D[33] ^ D[21] ^ D[19] ^ D[6] ^ D[5] ^ C[3] ^ C[13] ^
                C[14];
    NewCRC[8] = D[63] ^ D[62] ^ D[52] ^ D[48] ^ D[37] ^ D[36] ^ D[35] ^
                D[34] ^ D[22] ^ D[20] ^ D[7] ^ D[6] ^ C[0] ^ C[4] ^
                C[14] ^ C[15];
    NewCRC[9] = D[63] ^ D[53] ^ D[49] ^ D[38] ^ D[37] ^ D[36] ^ D[35] ^
                D[23] ^ D[21] ^ D[8] ^ D[7] ^ C[1] ^ C[5] ^ C[15];
    NewCRC[10] = D[54] ^ D[50] ^ D[39] ^ D[38] ^ D[37] ^ D[36] ^ D[24] ^
                 D[22] ^ D[9] ^ D[8] ^ C[2] ^ C[6];
    NewCRC[11] = D[55] ^ D[51] ^ D[40] ^ D[39] ^ D[38] ^ D[37] ^ D[25] ^
                 D[23] ^ D[10] ^ D[9] ^ C[3] ^ C[7];
    NewCRC[12] = D[56] ^ D[52] ^ D[41] ^ D[40] ^ D[39] ^ D[38] ^ D[26] ^
                 D[24] ^ D[11] ^ D[10] ^ C[4] ^ C[8];
    NewCRC[13] = D[57] ^ D[53] ^ D[42] ^ D[41] ^ D[40] ^ D[39] ^ D[27] ^
                 D[25] ^ D[12] ^ D[11] ^ C[5] ^ C[9];
    NewCRC[14] = D[58] ^ D[54] ^ D[43] ^ D[42] ^ D[41] ^ D[40] ^ D[28] ^
                 D[26] ^ D[13] ^ D[12] ^ C[6] ^ C[10];
    NewCRC[15] = D[63] ^ D[62] ^ D[61] ^ D[60] ^ D[59] ^ D[54] ^ D[53] ^
                 D[52] ^ D[51] ^ D[50] ^ D[49] ^ D[48] ^ D[47] ^ D[46] ^
                 D[45] ^ D[44] ^ D[42] ^ D[40] ^ D[39] ^ D[38] ^ D[37] ^
                 D[36] ^ D[35] ^ D[34] ^ D[33] ^ D[32] ^ D[31] ^ D[30] ^
                 D[29] ^ D[26] ^ D[25] ^ D[24] ^ D[23] ^ D[22] ^ D[21] ^
                 D[20] ^ D[19] ^ D[18] ^ D[17] ^ D[16] ^ D[15] ^ D[14] ^
                 D[12] ^ D[11] ^ D[10] ^ D[9] ^ D[8] ^ D[7] ^ D[6] ^
                 D[5] ^ D[4] ^ D[3] ^ D[2] ^ D[1] ^ D[0] ^ C[0] ^ C[1] ^
                 C[2] ^ C[3] ^ C[4] ^ C[5] ^ C[6] ^ C[11] ^ C[12] ^
                 C[13] ^ C[14] ^ C[15];

    result = NewCRC[15] << 15 | NewCRC[14] << 14 | NewCRC[13] << 13 | NewCRC[12] << 12
               | NewCRC[11] << 11 | NewCRC[10] << 10 | NewCRC[9] << 9 | NewCRC[8] << 8
               | NewCRC[7] << 7 | NewCRC[6] << 6 | NewCRC[5] << 5 | NewCRC[4] << 4
               | NewCRC[3] << 3 | NewCRC[2] << 2 | NewCRC[1] << 1 | NewCRC[0];

    return  (result & ((1 << (8 + bit_num)) - 1));

}

/**
 @brief mac hash right bucket arithmetic
*/
int16
sys_humber_hash_generate_mac_hash1(uint8* sed, uint32 bit_num)
{
    uint8 D[64] = {0}, C[16] = {0};
    uint8 NewCRC[16] = {0};
    uint32 i ;
    uint16 result = 0;

    for (i = 0; i < 64; i++)
    {
        D[i] = IS_BIT_SET(sed[i/8], i%8);
    }

    NewCRC[0] = D[63] ^ D[58] ^ D[56] ^ D[55] ^ D[52] ^ D[51] ^ D[49] ^
                D[48] ^ D[42] ^ D[35] ^ D[33] ^ D[32] ^ D[28] ^ D[27] ^
                D[26] ^ D[22] ^ D[20] ^ D[19] ^ D[12] ^ D[11] ^ D[8] ^
                D[4] ^ D[0] ^ C[0] ^ C[1] ^ C[3] ^ C[4] ^ C[7] ^ C[8] ^
                C[10] ^ C[15];
    NewCRC[1] = D[59] ^ D[57] ^ D[56] ^ D[53] ^ D[52] ^ D[50] ^ D[49] ^
                D[43] ^ D[36] ^ D[34] ^ D[33] ^ D[29] ^ D[28] ^ D[27] ^
                D[23] ^ D[21] ^ D[20] ^ D[13] ^ D[12] ^ D[9] ^ D[5] ^
                D[1] ^ C[1] ^ C[2] ^ C[4] ^ C[5] ^ C[8] ^ C[9] ^ C[11];
    NewCRC[2] = D[60] ^ D[58] ^ D[57] ^ D[54] ^ D[53] ^ D[51] ^ D[50] ^
                D[44] ^ D[37] ^ D[35] ^ D[34] ^ D[30] ^ D[29] ^ D[28] ^
                D[24] ^ D[22] ^ D[21] ^ D[14] ^ D[13] ^ D[10] ^ D[6] ^
                D[2] ^ C[2] ^ C[3] ^ C[5] ^ C[6] ^ C[9] ^ C[10] ^ C[12];
    NewCRC[3] = D[61] ^ D[59] ^ D[58] ^ D[55] ^ D[54] ^ D[52] ^ D[51] ^
                D[45] ^ D[38] ^ D[36] ^ D[35] ^ D[31] ^ D[30] ^ D[29] ^
                D[25] ^ D[23] ^ D[22] ^ D[15] ^ D[14] ^ D[11] ^ D[7] ^
                D[3] ^ C[3] ^ C[4] ^ C[6] ^ C[7] ^ C[10] ^ C[11] ^
                C[13];
    NewCRC[4] = D[62] ^ D[60] ^ D[59] ^ D[56] ^ D[55] ^ D[53] ^ D[52] ^
                D[46] ^ D[39] ^ D[37] ^ D[36] ^ D[32] ^ D[31] ^ D[30] ^
                D[26] ^ D[24] ^ D[23] ^ D[16] ^ D[15] ^ D[12] ^ D[8] ^
                D[4] ^ C[4] ^ C[5] ^ C[7] ^ C[8] ^ C[11] ^ C[12] ^
                C[14];
    NewCRC[5] = D[61] ^ D[60] ^ D[58] ^ D[57] ^ D[55] ^ D[54] ^ D[53] ^
                D[52] ^ D[51] ^ D[49] ^ D[48] ^ D[47] ^ D[42] ^ D[40] ^
                D[38] ^ D[37] ^ D[35] ^ D[31] ^ D[28] ^ D[26] ^ D[25] ^
                D[24] ^ D[22] ^ D[20] ^ D[19] ^ D[17] ^ D[16] ^ D[13] ^
                D[12] ^ D[11] ^ D[9] ^ D[8] ^ D[5] ^ D[4] ^ D[0] ^
                C[0] ^ C[1] ^ C[3] ^ C[4] ^ C[5] ^ C[6] ^ C[7] ^ C[9] ^
                C[10] ^ C[12] ^ C[13];
    NewCRC[6] = D[62] ^ D[61] ^ D[59] ^ D[58] ^ D[56] ^ D[55] ^ D[54] ^
                D[53] ^ D[52] ^ D[50] ^ D[49] ^ D[48] ^ D[43] ^ D[41] ^
                D[39] ^ D[38] ^ D[36] ^ D[32] ^ D[29] ^ D[27] ^ D[26] ^
                D[25] ^ D[23] ^ D[21] ^ D[20] ^ D[18] ^ D[17] ^ D[14] ^
                D[13] ^ D[12] ^ D[10] ^ D[9] ^ D[6] ^ D[5] ^ D[1] ^
                C[0] ^ C[1] ^ C[2] ^ C[4] ^ C[5] ^ C[6] ^ C[7] ^ C[8] ^
                C[10] ^ C[11] ^ C[13] ^ C[14];
    NewCRC[7] = D[63] ^ D[62] ^ D[60] ^ D[59] ^ D[57] ^ D[56] ^ D[55] ^
                D[54] ^ D[53] ^ D[51] ^ D[50] ^ D[49] ^ D[44] ^ D[42] ^
                D[40] ^ D[39] ^ D[37] ^ D[33] ^ D[30] ^ D[28] ^ D[27] ^
                D[26] ^ D[24] ^ D[22] ^ D[21] ^ D[19] ^ D[18] ^ D[15] ^
                D[14] ^ D[13] ^ D[11] ^ D[10] ^ D[7] ^ D[6] ^ D[2] ^
                C[1] ^ C[2] ^ C[3] ^ C[5] ^ C[6] ^ C[7] ^ C[8] ^ C[9] ^
                C[11] ^ C[12] ^ C[14] ^ C[15];
    NewCRC[8] = D[63] ^ D[61] ^ D[60] ^ D[58] ^ D[57] ^ D[56] ^ D[55] ^
                D[54] ^ D[52] ^ D[51] ^ D[50] ^ D[45] ^ D[43] ^ D[41] ^
                D[40] ^ D[38] ^ D[34] ^ D[31] ^ D[29] ^ D[28] ^ D[27] ^
                D[25] ^ D[23] ^ D[22] ^ D[20] ^ D[19] ^ D[16] ^ D[15] ^
                D[14] ^ D[12] ^ D[11] ^ D[8] ^ D[7] ^ D[3] ^ C[2] ^
                C[3] ^ C[4] ^ C[6] ^ C[7] ^ C[8] ^ C[9] ^ C[10] ^ C[12] ^
                C[13] ^ C[15];
    NewCRC[9] = D[62] ^ D[61] ^ D[59] ^ D[58] ^ D[57] ^ D[56] ^ D[55] ^
                D[53] ^ D[52] ^ D[51] ^ D[46] ^ D[44] ^ D[42] ^ D[41] ^
                D[39] ^ D[35] ^ D[32] ^ D[30] ^ D[29] ^ D[28] ^ D[26] ^
                D[24] ^ D[23] ^ D[21] ^ D[20] ^ D[17] ^ D[16] ^ D[15] ^
                D[13] ^ D[12] ^ D[9] ^ D[8] ^ D[4] ^ C[3] ^ C[4] ^
                C[5] ^ C[7] ^ C[8] ^ C[9] ^ C[10] ^ C[11] ^ C[13] ^
                C[14];
    NewCRC[10] = D[63] ^ D[62] ^ D[60] ^ D[59] ^ D[58] ^ D[57] ^ D[56] ^
                 D[54] ^ D[53] ^ D[52] ^ D[47] ^ D[45] ^ D[43] ^ D[42] ^
                 D[40] ^ D[36] ^ D[33] ^ D[31] ^ D[30] ^ D[29] ^ D[27] ^
                 D[25] ^ D[24] ^ D[22] ^ D[21] ^ D[18] ^ D[17] ^ D[16] ^
                 D[14] ^ D[13] ^ D[10] ^ D[9] ^ D[5] ^ C[4] ^ C[5] ^
                 C[6] ^ C[8] ^ C[9] ^ C[10] ^ C[11] ^ C[12] ^ C[14] ^
                 C[15];
    NewCRC[11] = D[63] ^ D[61] ^ D[60] ^ D[59] ^ D[58] ^ D[57] ^ D[55] ^
                 D[54] ^ D[53] ^ D[48] ^ D[46] ^ D[44] ^ D[43] ^ D[41] ^
                 D[37] ^ D[34] ^ D[32] ^ D[31] ^ D[30] ^ D[28] ^ D[26] ^
                 D[25] ^ D[23] ^ D[22] ^ D[19] ^ D[18] ^ D[17] ^ D[15] ^
                 D[14] ^ D[11] ^ D[10] ^ D[6] ^ C[0] ^ C[5] ^ C[6] ^
                 C[7] ^ C[9] ^ C[10] ^ C[11] ^ C[12] ^ C[13] ^ C[15];
    NewCRC[12] = D[63] ^ D[62] ^ D[61] ^ D[60] ^ D[59] ^ D[54] ^ D[52] ^
                 D[51] ^ D[48] ^ D[47] ^ D[45] ^ D[44] ^ D[38] ^ D[31] ^
                 D[29] ^ D[28] ^ D[24] ^ D[23] ^ D[22] ^ D[18] ^ D[16] ^
                 D[15] ^ D[8] ^ D[7] ^ D[4] ^ D[0] ^ C[0] ^ C[3] ^ C[4] ^
                 C[6] ^ C[11] ^ C[12] ^ C[13] ^ C[14] ^ C[15];
    NewCRC[13] = D[63] ^ D[62] ^ D[61] ^ D[60] ^ D[55] ^ D[53] ^ D[52] ^
                 D[49] ^ D[48] ^ D[46] ^ D[45] ^ D[39] ^ D[32] ^ D[30] ^
                 D[29] ^ D[25] ^ D[24] ^ D[23] ^ D[19] ^ D[17] ^ D[16] ^
                 D[9] ^ D[8] ^ D[5] ^ D[1] ^ C[0] ^ C[1] ^ C[4] ^ C[5] ^
                 C[7] ^ C[12] ^ C[13] ^ C[14] ^ C[15];
    NewCRC[14] = D[63] ^ D[62] ^ D[61] ^ D[56] ^ D[54] ^ D[53] ^ D[50] ^
                 D[49] ^ D[47] ^ D[46] ^ D[40] ^ D[33] ^ D[31] ^ D[30] ^
                 D[26] ^ D[25] ^ D[24] ^ D[20] ^ D[18] ^ D[17] ^ D[10] ^
                 D[9] ^ D[6] ^ D[2] ^ C[1] ^ C[2] ^ C[5] ^ C[6] ^ C[8] ^
                 C[13] ^ C[14] ^ C[15];
    NewCRC[15] = D[63] ^ D[62] ^ D[57] ^ D[55] ^ D[54] ^ D[51] ^ D[50] ^
                 D[48] ^ D[47] ^ D[41] ^ D[34] ^ D[32] ^ D[31] ^ D[27] ^
                 D[26] ^ D[25] ^ D[21] ^ D[19] ^ D[18] ^ D[11] ^ D[10] ^
                 D[7] ^ D[3] ^ C[0] ^ C[2] ^ C[3] ^ C[6] ^ C[7] ^ C[9] ^
                 C[14] ^ C[15];
    result = NewCRC[15] << 15 | NewCRC[14] << 14 | NewCRC[13] << 13 | NewCRC[12] << 12
               | NewCRC[11] << 11 | NewCRC[10] << 10 | NewCRC[9] << 9 | NewCRC[8] << 8
               | NewCRC[7] << 7 | NewCRC[6] << 6 | NewCRC[5] << 5 | NewCRC[4] << 4
               | NewCRC[3] << 3 | NewCRC[2] << 2 | NewCRC[1] << 1 | NewCRC[0];
    return (result & ((1 << (8 + bit_num)) - 1));

}

/**
 @brief ipv4 hash left bucket arithmetic
*/
int16
sys_humber_hash_generate_ipv4_hash0(uint8* sed, uint32 bit_num)
{
    uint8 D[48] = {0}, C[16] = {0};
    uint8 NewCRC[16] = {0};
    uint32 i ;
    uint16 result = 0;
    for (i = 0; i < 48; i++)
    {
        D[i] = IS_BIT_SET(sed[i/8], i%8);
    }
    NewCRC[0] = D[47] ^ D[46] ^ D[45] ^ D[43] ^ D[41] ^ D[40] ^ D[39] ^
                D[38] ^ D[37] ^ D[36] ^ D[35] ^ D[34] ^ D[33] ^ D[32] ^
                D[31] ^ D[30] ^ D[27] ^ D[26] ^ D[25] ^ D[24] ^ D[23] ^
                D[22] ^ D[21] ^ D[20] ^ D[19] ^ D[18] ^ D[17] ^ D[16] ^
                D[15] ^ D[13] ^ D[12] ^ D[11] ^ D[10] ^ D[9] ^ D[8] ^
                D[7] ^ D[6] ^ D[5] ^ D[4] ^ D[3] ^ D[2] ^ D[1] ^ D[0] ^
                C[0] ^ C[1] ^ C[2] ^ C[3] ^ C[4] ^ C[5] ^ C[6] ^ C[7] ^
                C[8] ^ C[9] ^ C[11] ^ C[13] ^ C[14] ^ C[15];
    NewCRC[1] = D[47] ^ D[46] ^ D[44] ^ D[42] ^ D[41] ^ D[40] ^ D[39] ^
                D[38] ^ D[37] ^ D[36] ^ D[35] ^ D[34] ^ D[33] ^ D[32] ^
                D[31] ^ D[28] ^ D[27] ^ D[26] ^ D[25] ^ D[24] ^ D[23] ^
                D[22] ^ D[21] ^ D[20] ^ D[19] ^ D[18] ^ D[17] ^ D[16] ^
                D[14] ^ D[13] ^ D[12] ^ D[11] ^ D[10] ^ D[9] ^ D[8] ^
                D[7] ^ D[6] ^ D[5] ^ D[4] ^ D[3] ^ D[2] ^ D[1] ^ C[0] ^
                C[1] ^ C[2] ^ C[3] ^ C[4] ^ C[5] ^ C[6] ^ C[7] ^ C[8] ^
                C[9] ^ C[10] ^ C[12] ^ C[14] ^ C[15];
    NewCRC[2] = D[46] ^ D[42] ^ D[31] ^ D[30] ^ D[29] ^ D[28] ^ D[16] ^
                D[14] ^ D[1] ^ D[0] ^ C[10] ^ C[14];
    NewCRC[3] = D[47] ^ D[43] ^ D[32] ^ D[31] ^ D[30] ^ D[29] ^ D[17] ^
                D[15] ^ D[2] ^ D[1] ^ C[0] ^ C[11] ^ C[15];
    NewCRC[4] = D[44] ^ D[33] ^ D[32] ^ D[31] ^ D[30] ^ D[18] ^ D[16] ^
                D[3] ^ D[2] ^ C[0] ^ C[1] ^ C[12];
    NewCRC[5] = D[45] ^ D[34] ^ D[33] ^ D[32] ^ D[31] ^ D[19] ^ D[17] ^
                D[4] ^ D[3] ^ C[0] ^ C[1] ^ C[2] ^ C[13];
    NewCRC[6] = D[46] ^ D[35] ^ D[34] ^ D[33] ^ D[32] ^ D[20] ^ D[18] ^
                D[5] ^ D[4] ^ C[0] ^ C[1] ^ C[2] ^ C[3] ^ C[14];
    NewCRC[7] = D[47] ^ D[36] ^ D[35] ^ D[34] ^ D[33] ^ D[21] ^ D[19] ^
                D[6] ^ D[5] ^ C[1] ^ C[2] ^ C[3] ^ C[4] ^ C[15];
    NewCRC[8] = D[37] ^ D[36] ^ D[35] ^ D[34] ^ D[22] ^ D[20] ^ D[7] ^
                D[6] ^ C[2] ^ C[3] ^ C[4] ^ C[5];
    NewCRC[9] = D[38] ^ D[37] ^ D[36] ^ D[35] ^ D[23] ^ D[21] ^ D[8] ^
                D[7] ^ C[3] ^ C[4] ^ C[5] ^ C[6];
    NewCRC[10] = D[39] ^ D[38] ^ D[37] ^ D[36] ^ D[24] ^ D[22] ^ D[9] ^
                 D[8] ^ C[4] ^ C[5] ^ C[6] ^ C[7];
    NewCRC[11] = D[40] ^ D[39] ^ D[38] ^ D[37] ^ D[25] ^ D[23] ^ D[10] ^
                 D[9] ^ C[5] ^ C[6] ^ C[7] ^ C[8];
    NewCRC[12] = D[41] ^ D[40] ^ D[39] ^ D[38] ^ D[26] ^ D[24] ^ D[11] ^
                 D[10] ^ C[6] ^ C[7] ^ C[8] ^ C[9];
    NewCRC[13] = D[42] ^ D[41] ^ D[40] ^ D[39] ^ D[27] ^ D[25] ^ D[12] ^
                 D[11] ^ C[7] ^ C[8] ^ C[9] ^ C[10];
    NewCRC[14] = D[43] ^ D[42] ^ D[41] ^ D[40] ^ D[28] ^ D[26] ^ D[13] ^
                 D[12] ^ C[8] ^ C[9] ^ C[10] ^ C[11];
    NewCRC[15] = D[47] ^ D[46] ^ D[45] ^ D[44] ^ D[42] ^ D[40] ^ D[39] ^
                 D[38] ^ D[37] ^ D[36] ^ D[35] ^ D[34] ^ D[33] ^ D[32] ^
                 D[31] ^ D[30] ^ D[29] ^ D[26] ^ D[25] ^ D[24] ^ D[23] ^
                 D[22] ^ D[21] ^ D[20] ^ D[19] ^ D[18] ^ D[17] ^ D[16] ^
                 D[15] ^ D[14] ^ D[12] ^ D[11] ^ D[10] ^ D[9] ^ D[8] ^
                 D[7] ^ D[6] ^ D[5] ^ D[4] ^ D[3] ^ D[2] ^ D[1] ^ D[0] ^
                 C[0] ^ C[1] ^ C[2] ^ C[3] ^ C[4] ^ C[5] ^ C[6] ^ C[7] ^
                 C[8] ^ C[10] ^ C[12] ^ C[13] ^ C[14] ^ C[15];

    result = NewCRC[15] << 15 | NewCRC[14] << 14 | NewCRC[13] << 13 | NewCRC[12] << 12
               | NewCRC[11] << 11 | NewCRC[10] << 10 | NewCRC[9] << 9 | NewCRC[8] << 8
               | NewCRC[7] << 7 | NewCRC[6] << 6 | NewCRC[5] << 5 | NewCRC[4] << 4
               | NewCRC[3] << 3 | NewCRC[2] << 2 | NewCRC[1] << 1 | NewCRC[0];
    return result & ((1 << (8 + bit_num)) - 1);

}

/**
 @brief ipv4 hash right bucket arithmetic
*/
int16
sys_humber_hash_generate_ipv4_hash1(uint8* sed, uint32 bit_num)
{
    uint8 D[48] = {0}, C[16] = {0};
    uint8 NewCRC[16] = {0};
    uint32 i ;
    uint16 result = 0;
    for (i = 0; i < 48; i++)
    {
        D[i] = IS_BIT_SET(sed[i/8], i%8);
    }
    NewCRC[0] = D[42] ^ D[35] ^ D[33] ^ D[32] ^ D[28] ^ D[27] ^ D[26] ^
                D[22] ^ D[20] ^ D[19] ^ D[12] ^ D[11] ^ D[8] ^ D[4] ^
                D[0] ^ C[0] ^ C[1] ^ C[3] ^ C[10];
    NewCRC[1] = D[43] ^ D[36] ^ D[34] ^ D[33] ^ D[29] ^ D[28] ^ D[27] ^
                D[23] ^ D[21] ^ D[20] ^ D[13] ^ D[12] ^ D[9] ^ D[5] ^
                D[1] ^ C[1] ^ C[2] ^ C[4] ^ C[11];
    NewCRC[2] = D[44] ^ D[37] ^ D[35] ^ D[34] ^ D[30] ^ D[29] ^ D[28] ^
                D[24] ^ D[22] ^ D[21] ^ D[14] ^ D[13] ^ D[10] ^ D[6] ^
                D[2] ^ C[2] ^ C[3] ^ C[5] ^ C[12];
    NewCRC[3] = D[45] ^ D[38] ^ D[36] ^ D[35] ^ D[31] ^ D[30] ^ D[29] ^
                D[25] ^ D[23] ^ D[22] ^ D[15] ^ D[14] ^ D[11] ^ D[7] ^
                D[3] ^ C[3] ^ C[4] ^ C[6] ^ C[13];
    NewCRC[4] = D[46] ^ D[39] ^ D[37] ^ D[36] ^ D[32] ^ D[31] ^ D[30] ^
                D[26] ^ D[24] ^ D[23] ^ D[16] ^ D[15] ^ D[12] ^ D[8] ^
                D[4] ^ C[0] ^ C[4] ^ C[5] ^ C[7] ^ C[14];
    NewCRC[5] = D[47] ^ D[42] ^ D[40] ^ D[38] ^ D[37] ^ D[35] ^ D[31] ^
                D[28] ^ D[26] ^ D[25] ^ D[24] ^ D[22] ^ D[20] ^ D[19] ^
                D[17] ^ D[16] ^ D[13] ^ D[12] ^ D[11] ^ D[9] ^ D[8] ^
                D[5] ^ D[4] ^ D[0] ^ C[3] ^ C[5] ^ C[6] ^ C[8] ^ C[10] ^
                C[15];
    NewCRC[6] = D[43] ^ D[41] ^ D[39] ^ D[38] ^ D[36] ^ D[32] ^ D[29] ^
                D[27] ^ D[26] ^ D[25] ^ D[23] ^ D[21] ^ D[20] ^ D[18] ^
                D[17] ^ D[14] ^ D[13] ^ D[12] ^ D[10] ^ D[9] ^ D[6] ^
                D[5] ^ D[1] ^ C[0] ^ C[4] ^ C[6] ^ C[7] ^ C[9] ^ C[11];
    NewCRC[7] = D[44] ^ D[42] ^ D[40] ^ D[39] ^ D[37] ^ D[33] ^ D[30] ^
                D[28] ^ D[27] ^ D[26] ^ D[24] ^ D[22] ^ D[21] ^ D[19] ^
                D[18] ^ D[15] ^ D[14] ^ D[13] ^ D[11] ^ D[10] ^ D[7] ^
                D[6] ^ D[2] ^ C[1] ^ C[5] ^ C[7] ^ C[8] ^ C[10] ^ C[12];
    NewCRC[8] = D[45] ^ D[43] ^ D[41] ^ D[40] ^ D[38] ^ D[34] ^ D[31] ^
                D[29] ^ D[28] ^ D[27] ^ D[25] ^ D[23] ^ D[22] ^ D[20] ^
                D[19] ^ D[16] ^ D[15] ^ D[14] ^ D[12] ^ D[11] ^ D[8] ^
                D[7] ^ D[3] ^ C[2] ^ C[6] ^ C[8] ^ C[9] ^ C[11] ^ C[13];
    NewCRC[9] = D[46] ^ D[44] ^ D[42] ^ D[41] ^ D[39] ^ D[35] ^ D[32] ^
                D[30] ^ D[29] ^ D[28] ^ D[26] ^ D[24] ^ D[23] ^ D[21] ^
                D[20] ^ D[17] ^ D[16] ^ D[15] ^ D[13] ^ D[12] ^ D[9] ^
                D[8] ^ D[4] ^ C[0] ^ C[3] ^ C[7] ^ C[9] ^ C[10] ^ C[12] ^
                C[14];
    NewCRC[10] = D[47] ^ D[45] ^ D[43] ^ D[42] ^ D[40] ^ D[36] ^ D[33] ^
                 D[31] ^ D[30] ^ D[29] ^ D[27] ^ D[25] ^ D[24] ^ D[22] ^
                 D[21] ^ D[18] ^ D[17] ^ D[16] ^ D[14] ^ D[13] ^ D[10] ^
                 D[9] ^ D[5] ^ C[1] ^ C[4] ^ C[8] ^ C[10] ^ C[11] ^
                 C[13] ^ C[15];
    NewCRC[11] = D[46] ^ D[44] ^ D[43] ^ D[41] ^ D[37] ^ D[34] ^ D[32] ^
                 D[31] ^ D[30] ^ D[28] ^ D[26] ^ D[25] ^ D[23] ^ D[22] ^
                 D[19] ^ D[18] ^ D[17] ^ D[15] ^ D[14] ^ D[11] ^ D[10] ^
                 D[6] ^ C[0] ^ C[2] ^ C[5] ^ C[9] ^ C[11] ^ C[12] ^
                 C[14];
    NewCRC[12] = D[47] ^ D[45] ^ D[44] ^ D[38] ^ D[31] ^ D[29] ^ D[28] ^
                 D[24] ^ D[23] ^ D[22] ^ D[18] ^ D[16] ^ D[15] ^ D[8] ^
                 D[7] ^ D[4] ^ D[0] ^ C[6] ^ C[12] ^ C[13] ^ C[15];
    NewCRC[13] = D[46] ^ D[45] ^ D[39] ^ D[32] ^ D[30] ^ D[29] ^ D[25] ^
                 D[24] ^ D[23] ^ D[19] ^ D[17] ^ D[16] ^ D[9] ^ D[8] ^
                 D[5] ^ D[1] ^ C[0] ^ C[7] ^ C[13] ^ C[14];
    NewCRC[14] = D[47] ^ D[46] ^ D[40] ^ D[33] ^ D[31] ^ D[30] ^ D[26] ^
                 D[25] ^ D[24] ^ D[20] ^ D[18] ^ D[17] ^ D[10] ^ D[9] ^
                 D[6] ^ D[2] ^ C[1] ^ C[8] ^ C[14] ^ C[15];
    NewCRC[15] = D[47] ^ D[41] ^ D[34] ^ D[32] ^ D[31] ^ D[27] ^ D[26] ^
                 D[25] ^ D[21] ^ D[19] ^ D[18] ^ D[11] ^ D[10] ^ D[7] ^
                 D[3] ^ C[0] ^ C[2] ^ C[9] ^ C[15];

    result = NewCRC[15] << 15 | NewCRC[14] << 14 | NewCRC[13] << 13 | NewCRC[12] << 12
               | NewCRC[11] << 11 | NewCRC[10] << 10 | NewCRC[9] << 9 | NewCRC[8] << 8
               | NewCRC[7] << 7 | NewCRC[6] << 6 | NewCRC[5] << 5 | NewCRC[4] << 4
               | NewCRC[3] << 3 | NewCRC[2] << 2 | NewCRC[1] << 1 | NewCRC[0];
    return result & ((1 << (8 + bit_num)) - 1);
}

/**
 @brief ipv6 hash left bucket arithmetic
*/
int16
sys_humber_hash_generate_ipv6_hash0(uint8* sed, uint32 bit_num)
{
    uint8 D[144] = {0}, C[16] = {0};
    uint8 NewCRC[16] = {0};
    uint32 i ;
    uint16 result = 0;

    for (i = 0; i < 144; i++)
    {
        D[i] = IS_BIT_SET(sed[i/8], i%8);
    }

    NewCRC[0] = D[143] ^ D[142] ^ D[139] ^ D[138] ^ D[137] ^ D[136] ^
                D[135] ^ D[133] ^ D[132] ^ D[131] ^ D[130] ^ D[129] ^
                D[128] ^ D[127] ^ D[125] ^ D[124] ^ D[123] ^ D[122] ^
                D[121] ^ D[120] ^ D[111] ^ D[110] ^ D[109] ^ D[108] ^
                D[107] ^ D[106] ^ D[105] ^ D[103] ^ D[101] ^ D[99] ^
                D[97] ^ D[96] ^ D[95] ^ D[94] ^ D[93] ^ D[92] ^ D[91] ^
                D[90] ^ D[87] ^ D[86] ^ D[83] ^ D[82] ^ D[81] ^ D[80] ^
                D[79] ^ D[78] ^ D[77] ^ D[76] ^ D[75] ^ D[73] ^ D[72] ^
                D[71] ^ D[69] ^ D[68] ^ D[67] ^ D[66] ^ D[65] ^ D[64] ^
                D[63] ^ D[62] ^ D[61] ^ D[60] ^ D[55] ^ D[54] ^ D[53] ^
                D[52] ^ D[51] ^ D[50] ^ D[49] ^ D[48] ^ D[47] ^ D[46] ^
                D[45] ^ D[43] ^ D[41] ^ D[40] ^ D[39] ^ D[38] ^ D[37] ^
                D[36] ^ D[35] ^ D[34] ^ D[33] ^ D[32] ^ D[31] ^ D[30] ^
                D[27] ^ D[26] ^ D[25] ^ D[24] ^ D[23] ^ D[22] ^ D[21] ^
                D[20] ^ D[19] ^ D[18] ^ D[17] ^ D[16] ^ D[15] ^ D[13] ^
                D[12] ^ D[11] ^ D[10] ^ D[9] ^ D[8] ^ D[7] ^ D[6] ^
                D[5] ^ D[4] ^ D[3] ^ D[2] ^ D[1] ^ D[0] ^ C[0] ^ C[1] ^
                C[2] ^ C[3] ^ C[4] ^ C[5] ^ C[7] ^ C[8] ^ C[9] ^ C[10] ^
                C[11] ^ C[14] ^ C[15];
    NewCRC[1] = D[143] ^ D[140] ^ D[139] ^ D[138] ^ D[137] ^ D[136] ^
                D[134] ^ D[133] ^ D[132] ^ D[131] ^ D[130] ^ D[129] ^
                D[128] ^ D[126] ^ D[125] ^ D[124] ^ D[123] ^ D[122] ^
                D[121] ^ D[112] ^ D[111] ^ D[110] ^ D[109] ^ D[108] ^
                D[107] ^ D[106] ^ D[104] ^ D[102] ^ D[100] ^ D[98] ^
                D[97] ^ D[96] ^ D[95] ^ D[94] ^ D[93] ^ D[92] ^ D[91] ^
                D[88] ^ D[87] ^ D[84] ^ D[83] ^ D[82] ^ D[81] ^ D[80] ^
                D[79] ^ D[78] ^ D[77] ^ D[76] ^ D[74] ^ D[73] ^ D[72] ^
                D[70] ^ D[69] ^ D[68] ^ D[67] ^ D[66] ^ D[65] ^ D[64] ^
                D[63] ^ D[62] ^ D[61] ^ D[56] ^ D[55] ^ D[54] ^ D[53] ^
                D[52] ^ D[51] ^ D[50] ^ D[49] ^ D[48] ^ D[47] ^ D[46] ^
                D[44] ^ D[42] ^ D[41] ^ D[40] ^ D[39] ^ D[38] ^ D[37] ^
                D[36] ^ D[35] ^ D[34] ^ D[33] ^ D[32] ^ D[31] ^ D[28] ^
                D[27] ^ D[26] ^ D[25] ^ D[24] ^ D[23] ^ D[22] ^ D[21] ^
                D[20] ^ D[19] ^ D[18] ^ D[17] ^ D[16] ^ D[14] ^ D[13] ^
                D[12] ^ D[11] ^ D[10] ^ D[9] ^ D[8] ^ D[7] ^ D[6] ^
                D[5] ^ D[4] ^ D[3] ^ D[2] ^ D[1] ^ C[0] ^ C[1] ^ C[2] ^
                C[3] ^ C[4] ^ C[5] ^ C[6] ^ C[8] ^ C[9] ^ C[10] ^ C[11] ^
                C[12] ^ C[15];
    NewCRC[2] = D[143] ^ D[142] ^ D[141] ^ D[140] ^ D[136] ^ D[134] ^
                D[128] ^ D[126] ^ D[121] ^ D[120] ^ D[113] ^ D[112] ^
                D[106] ^ D[98] ^ D[91] ^ D[90] ^ D[89] ^ D[88] ^ D[87] ^
                D[86] ^ D[85] ^ D[84] ^ D[76] ^ D[74] ^ D[72] ^ D[70] ^
                D[61] ^ D[60] ^ D[57] ^ D[56] ^ D[46] ^ D[42] ^ D[31] ^
                D[30] ^ D[29] ^ D[28] ^ D[16] ^ D[14] ^ D[1] ^ D[0] ^
                C[0] ^ C[6] ^ C[8] ^ C[12] ^ C[13] ^ C[14] ^ C[15];
    NewCRC[3] = D[143] ^ D[142] ^ D[141] ^ D[137] ^ D[135] ^ D[129] ^
                D[127] ^ D[122] ^ D[121] ^ D[114] ^ D[113] ^ D[107] ^
                D[99] ^ D[92] ^ D[91] ^ D[90] ^ D[89] ^ D[88] ^ D[87] ^
                D[86] ^ D[85] ^ D[77] ^ D[75] ^ D[73] ^ D[71] ^ D[62] ^
                D[61] ^ D[58] ^ D[57] ^ D[47] ^ D[43] ^ D[32] ^ D[31] ^
                D[30] ^ D[29] ^ D[17] ^ D[15] ^ D[2] ^ D[1] ^ C[1] ^
                C[7] ^ C[9] ^ C[13] ^ C[14] ^ C[15];
    NewCRC[4] = D[143] ^ D[142] ^ D[138] ^ D[136] ^ D[130] ^ D[128] ^
                D[123] ^ D[122] ^ D[115] ^ D[114] ^ D[108] ^ D[100] ^
                D[93] ^ D[92] ^ D[91] ^ D[90] ^ D[89] ^ D[88] ^ D[87] ^
                D[86] ^ D[78] ^ D[76] ^ D[74] ^ D[72] ^ D[63] ^ D[62] ^
                D[59] ^ D[58] ^ D[48] ^ D[44] ^ D[33] ^ D[32] ^ D[31] ^
                D[30] ^ D[18] ^ D[16] ^ D[3] ^ D[2] ^ C[0] ^ C[2] ^
                C[8] ^ C[10] ^ C[14] ^ C[15];
    NewCRC[5] = D[143] ^ D[139] ^ D[137] ^ D[131] ^ D[129] ^ D[124] ^
                D[123] ^ D[116] ^ D[115] ^ D[109] ^ D[101] ^ D[94] ^
                D[93] ^ D[92] ^ D[91] ^ D[90] ^ D[89] ^ D[88] ^ D[87] ^
                D[79] ^ D[77] ^ D[75] ^ D[73] ^ D[64] ^ D[63] ^ D[60] ^
                D[59] ^ D[49] ^ D[45] ^ D[34] ^ D[33] ^ D[32] ^ D[31] ^
                D[19] ^ D[17] ^ D[4] ^ D[3] ^ C[1] ^ C[3] ^ C[9] ^
                C[11] ^ C[15];
    NewCRC[6] = D[140] ^ D[138] ^ D[132] ^ D[130] ^ D[125] ^ D[124] ^
                D[117] ^ D[116] ^ D[110] ^ D[102] ^ D[95] ^ D[94] ^
                D[93] ^ D[92] ^ D[91] ^ D[90] ^ D[89] ^ D[88] ^ D[80] ^
                D[78] ^ D[76] ^ D[74] ^ D[65] ^ D[64] ^ D[61] ^ D[60] ^
                D[50] ^ D[46] ^ D[35] ^ D[34] ^ D[33] ^ D[32] ^ D[20] ^
                D[18] ^ D[5] ^ D[4] ^ C[2] ^ C[4] ^ C[10] ^ C[12];
    NewCRC[7] = D[141] ^ D[139] ^ D[133] ^ D[131] ^ D[126] ^ D[125] ^
                D[118] ^ D[117] ^ D[111] ^ D[103] ^ D[96] ^ D[95] ^
                D[94] ^ D[93] ^ D[92] ^ D[91] ^ D[90] ^ D[89] ^ D[81] ^
                D[79] ^ D[77] ^ D[75] ^ D[66] ^ D[65] ^ D[62] ^ D[61] ^
                D[51] ^ D[47] ^ D[36] ^ D[35] ^ D[34] ^ D[33] ^ D[21] ^
                D[19] ^ D[6] ^ D[5] ^ C[3] ^ C[5] ^ C[11] ^ C[13];
    NewCRC[8] = D[142] ^ D[140] ^ D[134] ^ D[132] ^ D[127] ^ D[126] ^
                D[119] ^ D[118] ^ D[112] ^ D[104] ^ D[97] ^ D[96] ^
                D[95] ^ D[94] ^ D[93] ^ D[92] ^ D[91] ^ D[90] ^ D[82] ^
                D[80] ^ D[78] ^ D[76] ^ D[67] ^ D[66] ^ D[63] ^ D[62] ^
                D[52] ^ D[48] ^ D[37] ^ D[36] ^ D[35] ^ D[34] ^ D[22] ^
                D[20] ^ D[7] ^ D[6] ^ C[4] ^ C[6] ^ C[12] ^ C[14];
    NewCRC[9] = D[143] ^ D[141] ^ D[135] ^ D[133] ^ D[128] ^ D[127] ^
                D[120] ^ D[119] ^ D[113] ^ D[105] ^ D[98] ^ D[97] ^
                D[96] ^ D[95] ^ D[94] ^ D[93] ^ D[92] ^ D[91] ^ D[83] ^
                D[81] ^ D[79] ^ D[77] ^ D[68] ^ D[67] ^ D[64] ^ D[63] ^
                D[53] ^ D[49] ^ D[38] ^ D[37] ^ D[36] ^ D[35] ^ D[23] ^
                D[21] ^ D[8] ^ D[7] ^ C[0] ^ C[5] ^ C[7] ^ C[13] ^
                C[15];
    NewCRC[10] = D[142] ^ D[136] ^ D[134] ^ D[129] ^ D[128] ^ D[121] ^
                 D[120] ^ D[114] ^ D[106] ^ D[99] ^ D[98] ^ D[97] ^
                 D[96] ^ D[95] ^ D[94] ^ D[93] ^ D[92] ^ D[84] ^ D[82] ^
                 D[80] ^ D[78] ^ D[69] ^ D[68] ^ D[65] ^ D[64] ^ D[54] ^
                 D[50] ^ D[39] ^ D[38] ^ D[37] ^ D[36] ^ D[24] ^ D[22] ^
                 D[9] ^ D[8] ^ C[0] ^ C[1] ^ C[6] ^ C[8] ^ C[14];
    NewCRC[11] = D[143] ^ D[137] ^ D[135] ^ D[130] ^ D[129] ^ D[122] ^
                 D[121] ^ D[115] ^ D[107] ^ D[100] ^ D[99] ^ D[98] ^
                 D[97] ^ D[96] ^ D[95] ^ D[94] ^ D[93] ^ D[85] ^ D[83] ^
                 D[81] ^ D[79] ^ D[70] ^ D[69] ^ D[66] ^ D[65] ^ D[55] ^
                 D[51] ^ D[40] ^ D[39] ^ D[38] ^ D[37] ^ D[25] ^ D[23] ^
                 D[10] ^ D[9] ^ C[1] ^ C[2] ^ C[7] ^ C[9] ^ C[15];
    NewCRC[12] = D[138] ^ D[136] ^ D[131] ^ D[130] ^ D[123] ^ D[122] ^
                 D[116] ^ D[108] ^ D[101] ^ D[100] ^ D[99] ^ D[98] ^
                 D[97] ^ D[96] ^ D[95] ^ D[94] ^ D[86] ^ D[84] ^ D[82] ^
                 D[80] ^ D[71] ^ D[70] ^ D[67] ^ D[66] ^ D[56] ^ D[52] ^
                 D[41] ^ D[40] ^ D[39] ^ D[38] ^ D[26] ^ D[24] ^ D[11] ^
                 D[10] ^ C[2] ^ C[3] ^ C[8] ^ C[10];
    NewCRC[13] = D[139] ^ D[137] ^ D[132] ^ D[131] ^ D[124] ^ D[123] ^
                 D[117] ^ D[109] ^ D[102] ^ D[101] ^ D[100] ^ D[99] ^
                 D[98] ^ D[97] ^ D[96] ^ D[95] ^ D[87] ^ D[85] ^ D[83] ^
                 D[81] ^ D[72] ^ D[71] ^ D[68] ^ D[67] ^ D[57] ^ D[53] ^
                 D[42] ^ D[41] ^ D[40] ^ D[39] ^ D[27] ^ D[25] ^ D[12] ^
                 D[11] ^ C[3] ^ C[4] ^ C[9] ^ C[11];
    NewCRC[14] = D[140] ^ D[138] ^ D[133] ^ D[132] ^ D[125] ^ D[124] ^
                 D[118] ^ D[110] ^ D[103] ^ D[102] ^ D[101] ^ D[100] ^
                 D[99] ^ D[98] ^ D[97] ^ D[96] ^ D[88] ^ D[86] ^ D[84] ^
                 D[82] ^ D[73] ^ D[72] ^ D[69] ^ D[68] ^ D[58] ^ D[54] ^
                 D[43] ^ D[42] ^ D[41] ^ D[40] ^ D[28] ^ D[26] ^ D[13] ^
                 D[12] ^ C[4] ^ C[5] ^ C[10] ^ C[12];
    NewCRC[15] = D[143] ^ D[142] ^ D[141] ^ D[138] ^ D[137] ^ D[136] ^
                 D[135] ^ D[134] ^ D[132] ^ D[131] ^ D[130] ^ D[129] ^
                 D[128] ^ D[127] ^ D[126] ^ D[124] ^ D[123] ^ D[122] ^
                 D[121] ^ D[120] ^ D[119] ^ D[110] ^ D[109] ^ D[108] ^
                 D[107] ^ D[106] ^ D[105] ^ D[104] ^ D[102] ^ D[100] ^
                 D[98] ^ D[96] ^ D[95] ^ D[94] ^ D[93] ^ D[92] ^ D[91] ^
                 D[90] ^ D[89] ^ D[86] ^ D[85] ^ D[82] ^ D[81] ^ D[80] ^
                 D[79] ^ D[78] ^ D[77] ^ D[76] ^ D[75] ^ D[74] ^ D[72] ^
                 D[71] ^ D[70] ^ D[68] ^ D[67] ^ D[66] ^ D[65] ^ D[64] ^
                 D[63] ^ D[62] ^ D[61] ^ D[60] ^ D[59] ^ D[54] ^ D[53] ^
                 D[52] ^ D[51] ^ D[50] ^ D[49] ^ D[48] ^ D[47] ^ D[46] ^
                 D[45] ^ D[44] ^ D[42] ^ D[40] ^ D[39] ^ D[38] ^ D[37] ^
                 D[36] ^ D[35] ^ D[34] ^ D[33] ^ D[32] ^ D[31] ^ D[30] ^
                 D[29] ^ D[26] ^ D[25] ^ D[24] ^ D[23] ^ D[22] ^ D[21] ^
                 D[20] ^ D[19] ^ D[18] ^ D[17] ^ D[16] ^ D[15] ^ D[14] ^
                 D[12] ^ D[11] ^ D[10] ^ D[9] ^ D[8] ^ D[7] ^ D[6] ^
                 D[5] ^ D[4] ^ D[3] ^ D[2] ^ D[1] ^ D[0] ^ C[0] ^ C[1] ^
                 C[2] ^ C[3] ^ C[4] ^ C[6] ^ C[7] ^ C[8] ^ C[9] ^ C[10] ^
                 C[13] ^ C[14] ^ C[15];

    result = NewCRC[15] << 15 | NewCRC[14] << 14 | NewCRC[13] << 13 | NewCRC[12] << 12
               | NewCRC[11] << 11 | NewCRC[10] << 10 | NewCRC[9] << 9 | NewCRC[8] << 8
               | NewCRC[7] << 7 | NewCRC[6] << 6 | NewCRC[5] << 5 | NewCRC[4] << 4
               | NewCRC[3] << 3 | NewCRC[2] << 2 | NewCRC[1] << 1 | NewCRC[0];
    return result & ((1 << (8 + bit_num)) - 1);
}

/**
 @brief ipv6 hash right bucket arithmetic
*/
int16
sys_humber_hash_generate_ipv6_hash1(uint8* sed, uint32 bit_num)
{
    uint8 D[144] = {0}, C[16] = {0};
    uint8 NewCRC[16] = {0};
    uint32 i ;
    uint16 result = 0;

    for (i = 0; i < 144; i++)
    {
        D[i] = IS_BIT_SET(sed[i/8], i%8);
    }

    NewCRC[0] = D[143] ^ D[142] ^ D[141] ^ D[140] ^ D[139] ^ D[138] ^
                D[137] ^ D[136] ^ D[132] ^ D[127] ^ D[123] ^ D[121] ^
                D[118] ^ D[115] ^ D[113] ^ D[110] ^ D[109] ^ D[108] ^
                D[107] ^ D[106] ^ D[104] ^ D[98] ^ D[96] ^ D[95] ^
                D[88] ^ D[86] ^ D[84] ^ D[82] ^ D[81] ^ D[80] ^ D[77] ^
                D[75] ^ D[74] ^ D[72] ^ D[70] ^ D[67] ^ D[66] ^ D[65] ^
                D[64] ^ D[63] ^ D[58] ^ D[56] ^ D[55] ^ D[52] ^ D[51] ^
                D[49] ^ D[48] ^ D[42] ^ D[35] ^ D[33] ^ D[32] ^ D[28] ^
                D[27] ^ D[26] ^ D[22] ^ D[20] ^ D[19] ^ D[12] ^ D[11] ^
                D[8] ^ D[4] ^ D[0] ^ C[4] ^ C[8] ^ C[9] ^ C[10] ^ C[11] ^
                C[12] ^ C[13] ^ C[14] ^ C[15];
    NewCRC[1] = D[143] ^ D[142] ^ D[141] ^ D[140] ^ D[139] ^ D[138] ^
                D[137] ^ D[133] ^ D[128] ^ D[124] ^ D[122] ^ D[119] ^
                D[116] ^ D[114] ^ D[111] ^ D[110] ^ D[109] ^ D[108] ^
                D[107] ^ D[105] ^ D[99] ^ D[97] ^ D[96] ^ D[89] ^ D[87] ^
                D[85] ^ D[83] ^ D[82] ^ D[81] ^ D[78] ^ D[76] ^ D[75] ^
                D[73] ^ D[71] ^ D[68] ^ D[67] ^ D[66] ^ D[65] ^ D[64] ^
                D[59] ^ D[57] ^ D[56] ^ D[53] ^ D[52] ^ D[50] ^ D[49] ^
                D[43] ^ D[36] ^ D[34] ^ D[33] ^ D[29] ^ D[28] ^ D[27] ^
                D[23] ^ D[21] ^ D[20] ^ D[13] ^ D[12] ^ D[9] ^ D[5] ^
                D[1] ^ C[0] ^ C[5] ^ C[9] ^ C[10] ^ C[11] ^ C[12] ^
                C[13] ^ C[14] ^ C[15];
    NewCRC[2] = D[143] ^ D[142] ^ D[141] ^ D[140] ^ D[139] ^ D[138] ^
                D[134] ^ D[129] ^ D[125] ^ D[123] ^ D[120] ^ D[117] ^
                D[115] ^ D[112] ^ D[111] ^ D[110] ^ D[109] ^ D[108] ^
                D[106] ^ D[100] ^ D[98] ^ D[97] ^ D[90] ^ D[88] ^ D[86] ^
                D[84] ^ D[83] ^ D[82] ^ D[79] ^ D[77] ^ D[76] ^ D[74] ^
                D[72] ^ D[69] ^ D[68] ^ D[67] ^ D[66] ^ D[65] ^ D[60] ^
                D[58] ^ D[57] ^ D[54] ^ D[53] ^ D[51] ^ D[50] ^ D[44] ^
                D[37] ^ D[35] ^ D[34] ^ D[30] ^ D[29] ^ D[28] ^ D[24] ^
                D[22] ^ D[21] ^ D[14] ^ D[13] ^ D[10] ^ D[6] ^ D[2] ^
                C[1] ^ C[6] ^ C[10] ^ C[11] ^ C[12] ^ C[13] ^ C[14] ^
                C[15];
    NewCRC[3] = D[143] ^ D[142] ^ D[141] ^ D[140] ^ D[139] ^ D[135] ^
                D[130] ^ D[126] ^ D[124] ^ D[121] ^ D[118] ^ D[116] ^
                D[113] ^ D[112] ^ D[111] ^ D[110] ^ D[109] ^ D[107] ^
                D[101] ^ D[99] ^ D[98] ^ D[91] ^ D[89] ^ D[87] ^ D[85] ^
                D[84] ^ D[83] ^ D[80] ^ D[78] ^ D[77] ^ D[75] ^ D[73] ^
                D[70] ^ D[69] ^ D[68] ^ D[67] ^ D[66] ^ D[61] ^ D[59] ^
                D[58] ^ D[55] ^ D[54] ^ D[52] ^ D[51] ^ D[45] ^ D[38] ^
                D[36] ^ D[35] ^ D[31] ^ D[30] ^ D[29] ^ D[25] ^ D[23] ^
                D[22] ^ D[15] ^ D[14] ^ D[11] ^ D[7] ^ D[3] ^ C[2] ^
                C[7] ^ C[11] ^ C[12] ^ C[13] ^ C[14] ^ C[15];
    NewCRC[4] = D[143] ^ D[142] ^ D[141] ^ D[140] ^ D[136] ^ D[131] ^
                D[127] ^ D[125] ^ D[122] ^ D[119] ^ D[117] ^ D[114] ^
                D[113] ^ D[112] ^ D[111] ^ D[110] ^ D[108] ^ D[102] ^
                D[100] ^ D[99] ^ D[92] ^ D[90] ^ D[88] ^ D[86] ^ D[85] ^
                D[84] ^ D[81] ^ D[79] ^ D[78] ^ D[76] ^ D[74] ^ D[71] ^
                D[70] ^ D[69] ^ D[68] ^ D[67] ^ D[62] ^ D[60] ^ D[59] ^
                D[56] ^ D[55] ^ D[53] ^ D[52] ^ D[46] ^ D[39] ^ D[37] ^
                D[36] ^ D[32] ^ D[31] ^ D[30] ^ D[26] ^ D[24] ^ D[23] ^
                D[16] ^ D[15] ^ D[12] ^ D[8] ^ D[4] ^ C[3] ^ C[8] ^
                C[12] ^ C[13] ^ C[14] ^ C[15];
    NewCRC[5] = D[140] ^ D[139] ^ D[138] ^ D[136] ^ D[128] ^ D[127] ^
                D[126] ^ D[121] ^ D[120] ^ D[114] ^ D[112] ^ D[111] ^
                D[110] ^ D[108] ^ D[107] ^ D[106] ^ D[104] ^ D[103] ^
                D[101] ^ D[100] ^ D[98] ^ D[96] ^ D[95] ^ D[93] ^ D[91] ^
                D[89] ^ D[88] ^ D[87] ^ D[85] ^ D[84] ^ D[81] ^ D[79] ^
                D[74] ^ D[71] ^ D[69] ^ D[68] ^ D[67] ^ D[66] ^ D[65] ^
                D[64] ^ D[61] ^ D[60] ^ D[58] ^ D[57] ^ D[55] ^ D[54] ^
                D[53] ^ D[52] ^ D[51] ^ D[49] ^ D[48] ^ D[47] ^ D[42] ^
                D[40] ^ D[38] ^ D[37] ^ D[35] ^ D[31] ^ D[28] ^ D[26] ^
                D[25] ^ D[24] ^ D[22] ^ D[20] ^ D[19] ^ D[17] ^ D[16] ^
                D[13] ^ D[12] ^ D[11] ^ D[9] ^ D[8] ^ D[5] ^ D[4] ^
                D[0] ^ C[0] ^ C[8] ^ C[10] ^ C[11] ^ C[12];
    NewCRC[6] = D[141] ^ D[140] ^ D[139] ^ D[137] ^ D[129] ^ D[128] ^
                D[127] ^ D[122] ^ D[121] ^ D[115] ^ D[113] ^ D[112] ^
                D[111] ^ D[109] ^ D[108] ^ D[107] ^ D[105] ^ D[104] ^
                D[102] ^ D[101] ^ D[99] ^ D[97] ^ D[96] ^ D[94] ^ D[92] ^
                D[90] ^ D[89] ^ D[88] ^ D[86] ^ D[85] ^ D[82] ^ D[80] ^
                D[75] ^ D[72] ^ D[70] ^ D[69] ^ D[68] ^ D[67] ^ D[66] ^
                D[65] ^ D[62] ^ D[61] ^ D[59] ^ D[58] ^ D[56] ^ D[55] ^
                D[54] ^ D[53] ^ D[52] ^ D[50] ^ D[49] ^ D[48] ^ D[43] ^
                D[41] ^ D[39] ^ D[38] ^ D[36] ^ D[32] ^ D[29] ^ D[27] ^
                D[26] ^ D[25] ^ D[23] ^ D[21] ^ D[20] ^ D[18] ^ D[17] ^
                D[14] ^ D[13] ^ D[12] ^ D[10] ^ D[9] ^ D[6] ^ D[5] ^
                D[1] ^ C[0] ^ C[1] ^ C[9] ^ C[11] ^ C[12] ^ C[13];
    NewCRC[7] = D[142] ^ D[141] ^ D[140] ^ D[138] ^ D[130] ^ D[129] ^
                D[128] ^ D[123] ^ D[122] ^ D[116] ^ D[114] ^ D[113] ^
                D[112] ^ D[110] ^ D[109] ^ D[108] ^ D[106] ^ D[105] ^
                D[103] ^ D[102] ^ D[100] ^ D[98] ^ D[97] ^ D[95] ^
                D[93] ^ D[91] ^ D[90] ^ D[89] ^ D[87] ^ D[86] ^ D[83] ^
                D[81] ^ D[76] ^ D[73] ^ D[71] ^ D[70] ^ D[69] ^ D[68] ^
                D[67] ^ D[66] ^ D[63] ^ D[62] ^ D[60] ^ D[59] ^ D[57] ^
                D[56] ^ D[55] ^ D[54] ^ D[53] ^ D[51] ^ D[50] ^ D[49] ^
                D[44] ^ D[42] ^ D[40] ^ D[39] ^ D[37] ^ D[33] ^ D[30] ^
                D[28] ^ D[27] ^ D[26] ^ D[24] ^ D[22] ^ D[21] ^ D[19] ^
                D[18] ^ D[15] ^ D[14] ^ D[13] ^ D[11] ^ D[10] ^ D[7] ^
                D[6] ^ D[2] ^ C[0] ^ C[1] ^ C[2] ^ C[10] ^ C[12] ^
                C[13] ^ C[14];
    NewCRC[8] = D[143] ^ D[142] ^ D[141] ^ D[139] ^ D[131] ^ D[130] ^
                D[129] ^ D[124] ^ D[123] ^ D[117] ^ D[115] ^ D[114] ^
                D[113] ^ D[111] ^ D[110] ^ D[109] ^ D[107] ^ D[106] ^
                D[104] ^ D[103] ^ D[101] ^ D[99] ^ D[98] ^ D[96] ^
                D[94] ^ D[92] ^ D[91] ^ D[90] ^ D[88] ^ D[87] ^ D[84] ^
                D[82] ^ D[77] ^ D[74] ^ D[72] ^ D[71] ^ D[70] ^ D[69] ^
                D[68] ^ D[67] ^ D[64] ^ D[63] ^ D[61] ^ D[60] ^ D[58] ^
                D[57] ^ D[56] ^ D[55] ^ D[54] ^ D[52] ^ D[51] ^ D[50] ^
                D[45] ^ D[43] ^ D[41] ^ D[40] ^ D[38] ^ D[34] ^ D[31] ^
                D[29] ^ D[28] ^ D[27] ^ D[25] ^ D[23] ^ D[22] ^ D[20] ^
                D[19] ^ D[16] ^ D[15] ^ D[14] ^ D[12] ^ D[11] ^ D[8] ^
                D[7] ^ D[3] ^ C[1] ^ C[2] ^ C[3] ^ C[11] ^ C[13] ^
                C[14] ^ C[15];
    NewCRC[9] = D[143] ^ D[142] ^ D[140] ^ D[132] ^ D[131] ^ D[130] ^
                D[125] ^ D[124] ^ D[118] ^ D[116] ^ D[115] ^ D[114] ^
                D[112] ^ D[111] ^ D[110] ^ D[108] ^ D[107] ^ D[105] ^
                D[104] ^ D[102] ^ D[100] ^ D[99] ^ D[97] ^ D[95] ^
                D[93] ^ D[92] ^ D[91] ^ D[89] ^ D[88] ^ D[85] ^ D[83] ^
                D[78] ^ D[75] ^ D[73] ^ D[72] ^ D[71] ^ D[70] ^ D[69] ^
                D[68] ^ D[65] ^ D[64] ^ D[62] ^ D[61] ^ D[59] ^ D[58] ^
                D[57] ^ D[56] ^ D[55] ^ D[53] ^ D[52] ^ D[51] ^ D[46] ^
                D[44] ^ D[42] ^ D[41] ^ D[39] ^ D[35] ^ D[32] ^ D[30] ^
                D[29] ^ D[28] ^ D[26] ^ D[24] ^ D[23] ^ D[21] ^ D[20] ^
                D[17] ^ D[16] ^ D[15] ^ D[13] ^ D[12] ^ D[9] ^ D[8] ^
                D[4] ^ C[2] ^ C[3] ^ C[4] ^ C[12] ^ C[14] ^ C[15];
    NewCRC[10] = D[143] ^ D[141] ^ D[133] ^ D[132] ^ D[131] ^ D[126] ^
                 D[125] ^ D[119] ^ D[117] ^ D[116] ^ D[115] ^ D[113] ^
                 D[112] ^ D[111] ^ D[109] ^ D[108] ^ D[106] ^ D[105] ^
                 D[103] ^ D[101] ^ D[100] ^ D[98] ^ D[96] ^ D[94] ^
                 D[93] ^ D[92] ^ D[90] ^ D[89] ^ D[86] ^ D[84] ^ D[79] ^
                 D[76] ^ D[74] ^ D[73] ^ D[72] ^ D[71] ^ D[70] ^ D[69] ^
                 D[66] ^ D[65] ^ D[63] ^ D[62] ^ D[60] ^ D[59] ^ D[58] ^
                 D[57] ^ D[56] ^ D[54] ^ D[53] ^ D[52] ^ D[47] ^ D[45] ^
                 D[43] ^ D[42] ^ D[40] ^ D[36] ^ D[33] ^ D[31] ^ D[30] ^
                 D[29] ^ D[27] ^ D[25] ^ D[24] ^ D[22] ^ D[21] ^ D[18] ^
                 D[17] ^ D[16] ^ D[14] ^ D[13] ^ D[10] ^ D[9] ^ D[5] ^
                 C[3] ^ C[4] ^ C[5] ^ C[13] ^ C[15];
    NewCRC[11] = D[142] ^ D[134] ^ D[133] ^ D[132] ^ D[127] ^ D[126] ^
                 D[120] ^ D[118] ^ D[117] ^ D[116] ^ D[114] ^ D[113] ^
                 D[112] ^ D[110] ^ D[109] ^ D[107] ^ D[106] ^ D[104] ^
                 D[102] ^ D[101] ^ D[99] ^ D[97] ^ D[95] ^ D[94] ^ D[93] ^
                 D[91] ^ D[90] ^ D[87] ^ D[85] ^ D[80] ^ D[77] ^ D[75] ^
                 D[74] ^ D[73] ^ D[72] ^ D[71] ^ D[70] ^ D[67] ^ D[66] ^
                 D[64] ^ D[63] ^ D[61] ^ D[60] ^ D[59] ^ D[58] ^ D[57] ^
                 D[55] ^ D[54] ^ D[53] ^ D[48] ^ D[46] ^ D[44] ^ D[43] ^
                 D[41] ^ D[37] ^ D[34] ^ D[32] ^ D[31] ^ D[30] ^ D[28] ^
                 D[26] ^ D[25] ^ D[23] ^ D[22] ^ D[19] ^ D[18] ^ D[17] ^
                 D[15] ^ D[14] ^ D[11] ^ D[10] ^ D[6] ^ C[4] ^ C[5] ^
                 C[6] ^ C[14];
    NewCRC[12] = D[142] ^ D[141] ^ D[140] ^ D[139] ^ D[138] ^ D[137] ^
                 D[136] ^ D[135] ^ D[134] ^ D[133] ^ D[132] ^ D[128] ^
                 D[123] ^ D[119] ^ D[117] ^ D[114] ^ D[111] ^ D[109] ^
                 D[106] ^ D[105] ^ D[104] ^ D[103] ^ D[102] ^ D[100] ^
                 D[94] ^ D[92] ^ D[91] ^ D[84] ^ D[82] ^ D[80] ^ D[78] ^
                 D[77] ^ D[76] ^ D[73] ^ D[71] ^ D[70] ^ D[68] ^ D[66] ^
                 D[63] ^ D[62] ^ D[61] ^ D[60] ^ D[59] ^ D[54] ^ D[52] ^
                 D[51] ^ D[48] ^ D[47] ^ D[45] ^ D[44] ^ D[38] ^ D[31] ^
                 D[29] ^ D[28] ^ D[24] ^ D[23] ^ D[22] ^ D[18] ^ D[16] ^
                 D[15] ^ D[8] ^ D[7] ^ D[4] ^ D[0] ^ C[0] ^ C[4] ^ C[5] ^
                 C[6] ^ C[7] ^ C[8] ^ C[9] ^ C[10] ^ C[11] ^ C[12] ^
                 C[13] ^ C[14];
    NewCRC[13] = D[143] ^ D[142] ^ D[141] ^ D[140] ^ D[139] ^ D[138] ^
                 D[137] ^ D[136] ^ D[135] ^ D[134] ^ D[133] ^ D[129] ^
                 D[124] ^ D[120] ^ D[118] ^ D[115] ^ D[112] ^ D[110] ^
                 D[107] ^ D[106] ^ D[105] ^ D[104] ^ D[103] ^ D[101] ^
                 D[95] ^ D[93] ^ D[92] ^ D[85] ^ D[83] ^ D[81] ^ D[79] ^
                 D[78] ^ D[77] ^ D[74] ^ D[72] ^ D[71] ^ D[69] ^ D[67] ^
                 D[64] ^ D[63] ^ D[62] ^ D[61] ^ D[60] ^ D[55] ^ D[53] ^
                 D[52] ^ D[49] ^ D[48] ^ D[46] ^ D[45] ^ D[39] ^ D[32] ^
                 D[30] ^ D[29] ^ D[25] ^ D[24] ^ D[23] ^ D[19] ^ D[17] ^
                 D[16] ^ D[9] ^ D[8] ^ D[5] ^ D[1] ^ C[1] ^ C[5] ^ C[6] ^
                 C[7] ^ C[8] ^ C[9] ^ C[10] ^ C[11] ^ C[12] ^ C[13] ^
                 C[14] ^ C[15];
    NewCRC[14] = D[143] ^ D[142] ^ D[141] ^ D[140] ^ D[139] ^ D[138] ^
                 D[137] ^ D[136] ^ D[135] ^ D[134] ^ D[130] ^ D[125] ^
                 D[121] ^ D[119] ^ D[116] ^ D[113] ^ D[111] ^ D[108] ^
                 D[107] ^ D[106] ^ D[105] ^ D[104] ^ D[102] ^ D[96] ^
                 D[94] ^ D[93] ^ D[86] ^ D[84] ^ D[82] ^ D[80] ^ D[79] ^
                 D[78] ^ D[75] ^ D[73] ^ D[72] ^ D[70] ^ D[68] ^ D[65] ^
                 D[64] ^ D[63] ^ D[62] ^ D[61] ^ D[56] ^ D[54] ^ D[53] ^
                 D[50] ^ D[49] ^ D[47] ^ D[46] ^ D[40] ^ D[33] ^ D[31] ^
                 D[30] ^ D[26] ^ D[25] ^ D[24] ^ D[20] ^ D[18] ^ D[17] ^
                 D[10] ^ D[9] ^ D[6] ^ D[2] ^ C[2] ^ C[6] ^ C[7] ^ C[8] ^
                 C[9] ^ C[10] ^ C[11] ^ C[12] ^ C[13] ^ C[14] ^ C[15];
    NewCRC[15] = D[143] ^ D[142] ^ D[141] ^ D[140] ^ D[139] ^ D[138] ^
                 D[137] ^ D[136] ^ D[135] ^ D[131] ^ D[126] ^ D[122] ^
                 D[120] ^ D[117] ^ D[114] ^ D[112] ^ D[109] ^ D[108] ^
                 D[107] ^ D[106] ^ D[105] ^ D[103] ^ D[97] ^ D[95] ^
                 D[94] ^ D[87] ^ D[85] ^ D[83] ^ D[81] ^ D[80] ^ D[79] ^
                 D[76] ^ D[74] ^ D[73] ^ D[71] ^ D[69] ^ D[66] ^ D[65] ^
                 D[64] ^ D[63] ^ D[62] ^ D[57] ^ D[55] ^ D[54] ^ D[51] ^
                 D[50] ^ D[48] ^ D[47] ^ D[41] ^ D[34] ^ D[32] ^ D[31] ^
                 D[27] ^ D[26] ^ D[25] ^ D[21] ^ D[19] ^ D[18] ^ D[11] ^
                 D[10] ^ D[7] ^ D[3] ^ C[3] ^ C[7] ^ C[8] ^ C[9] ^ C[10] ^
                 C[11] ^ C[12] ^ C[13] ^ C[14] ^ C[15];

    result = NewCRC[15] << 15 | NewCRC[14] << 14 | NewCRC[13] << 13 | NewCRC[12] << 12
               | NewCRC[11] << 11 | NewCRC[10] << 10 | NewCRC[9] << 9 | NewCRC[8] << 8
               | NewCRC[7] << 7 | NewCRC[6] << 6 | NewCRC[5] << 5 | NewCRC[4] << 4
               | NewCRC[3] << 3 | NewCRC[2] << 2 | NewCRC[1] << 1 | NewCRC[0];
    return result & ((1 << (8 + bit_num)) - 1);
}


